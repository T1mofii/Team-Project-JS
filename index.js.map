{"version":3,"file":"index.js","sources":["../src/js/artists.js"],"sourcesContent":["// Imports\nimport axios from \"axios\";\nimport { stackTraceLimit } from \"postcss/lib/css-syntax-error\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n// Search Elements\nconst refs = {\n    cardItem: document.querySelector('.js-artist-card'),\n    loader: document.querySelector('.js-artist-loader'),\n    btnLoadMore: document.querySelector('.js-artist-loadmore-btn'),\n}\n\n\n\n\n\n// Function on Api\nasync function getArtistForQuery(page) {\n  const res = await axios.get('https://sound-wave.b.goit.study/api/artists', { \n    params: { page:page, limit:8, } \n  });\n    return res.data;\n    console.log(res.data);\n    \n}\n\n// Slice function\nfunction truncateText(text, maxLength) {\n  if (!text) return '';\n  return text.length > maxLength ? text.slice(0, maxLength) + '...' : text;\n}\n\n// Render Function\nfunction createArtists(artists) {\n    let markup = artists.map(artist => {\n        const genresMarkup = artist.genres\n            ? artist.genres.map(genre => `<li class=\"item-info-genre\">${genre}</li>`).join('')\n            : '';\n        let maxLength;\n        if (window.innerWidth < 320) {\n            maxLength = 64; \n        } else if (window.innerWidth < 768) {\n            maxLength = 64; \n        } else if (window.innerWidth < 1440) {\n            maxLength = 160; \n        } else {\n            maxLength = 139; \n        }\n    const shortBio = truncateText(artist.strBiographyEN, maxLength);\n        \n       return `<li class=\"artist-card-item\">\n                <img class=\"artist-card-img\" src=\"${artist.strArtistThumb}\" alt=\"${artist.strArtist}\" >\n                <ul class=\"artist-item-info\">\n                    ${genresMarkup}\n                </ul>\n                <div class=\"artist-info-container\">\n                    <h4 class=\"card-item-title\">${artist.strArtist}</h4>\n                    <p class=\"card-item-info\">\n                         ${shortBio}\n                    </p>\n                </div>\n                <div class=\"btn-learn-more-cont\">\n                    <button type=\"button\" class=\"artist-learn-btn\" data-artist-id=\"artist-modal\">Learn More </button>\n                    <svg width=\"8\" height=\"15\" viewBox=\"0 0 8 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                      <path d=\"M0 14.5492L8 7.54919L0 0.549194V14.5492Z\" fill=\"white\" />\n                    </svg>\n                </div>\n            </li>`;\n    }).join('');\n    return markup;\n    \n}\n\n// Functions\nfunction showLoader() {\n    if (refs.loader) {\n        refs.loader.classList.add('is-active-loader');\n    }\n}\n\nfunction hideLoader() {\n    if (refs.loader) {\n        refs.loader.classList.remove('is-active-loader');\n    }\n}\n\n\nfunction showLoadMoreButton() {\n    refs.btnLoadMore.disabled = false;\n    refs.btnLoadMore.classList.add('artist-load-more-btn-is-active');\n}\n\nfunction hideLoadMoreButton() {\n    refs.btnLoadMore.disabled = true;\n    refs.btnLoadMore.classList.remove('artist-load-more-btn-is-active');\n}\n\nlet currentPage;\nlet maxPage = 0;\nconst pageSize = 8;\n\n// Слухач на завантаження сторінки для відображення стрічки артистів.\ndocument.addEventListener('DOMContentLoaded', async () => {\n    currentPage = 1;\n    showLoader();\n    try {\n        const res = await getArtistForQuery(currentPage);\n        const arrOfArtist = res.artists;\n        const markup = createArtists(arrOfArtist);\n        \n        refs.cardItem.innerHTML = markup;\n\n\n        maxPage = Math.ceil(res.totalArtists / pageSize);\n        if (currentPage < maxPage) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n            iziToast.error({\n                message: \"We're sorry, but you've reached the end of search results.\"\n            });\n        }\n        \n    } catch {\n        maxPage = 0;\n        iziToast.error({\n            message: 'Sorry. Please try again!'\n        })\n    } finally {\n        hideLoader();\n    }\n});\n\n// Слухач на додаткове завантаження сторінки для відображення стрічки артистів.\nrefs.btnLoadMore.addEventListener('click', async () => {\n    currentPage += 1;\n    hideLoadMoreButton();\n    showLoader();\n    try {\n        const res = await getArtistForQuery(currentPage);\n\n        if (!res.artists.length) {\n            iziToast.info({\n                message: \"Sorry. Please try again!\"\n            });\n            return;\n        }\n        const arrOfArtist = res.artists;\n        const markup = createArtists(arrOfArtist);\n        refs.cardItem.insertAdjacentHTML('beforeend', markup);\n\n        const firstCard = document.querySelector('.artist-card-item');\n        if (!firstCard) return;\n        const cardHeight = firstCard.getBoundingClientRect().height;\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        });\n    } catch {\n        iziToast.error({\n            message: 'Sorry, there are no information. Please try again!'\n        });\n    }finally {\n        hideLoader();\n        if (currentPage < maxPage) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n            iziToast.error({\n                message: \"We're sorry, but you've reached the end of search results.\"\n            });\n        }\n    }\n});\n\n\n\n\n"],"names":["refs","getArtistForQuery","page","axios","truncateText","text","maxLength","createArtists","artists","artist","genresMarkup","genre","shortBio","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","currentPage","maxPage","pageSize","res","arrOfArtist","markup","iziToast","firstCard","cardHeight"],"mappings":"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"}